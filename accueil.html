<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<style>
    table {
        align-items: center;
        border-collapse: collapse;
        margin: auto;

    }
    td{
        border: 1px solid black;
        text-align: center;
        padding: 10px;
    }
</style>
<body>

<p style="text-align: center">Écritures présentes dans le compte : </p>

<table id="table" >
    <thead>
        <td>Uuid</td>
        <td>Label</td>
        <td>Date</td>
        <td>Montant</td>
        <td>Type</td>
        <td>Créer le </td>
        <td>Modifier le</td>
    </thead>
</table>

<button style="display:block;margin: 10px auto">Nouveau</button>

</body>
<script>
    var body = document.querySelector("table")
    var requestURL = 'https://127.0.0.1:8000/api/comptes/e90b7413-77da-406a-ac0c-d20dc46db5e2/ecritures';
    var request = new XMLHttpRequest()

    request.open('GET',requestURL)
    request.responseType = 'json';
    request.send();

    window.onload = function() {

        var donnees = fetch('https://127.0.0.1:8000/api/comptes/e90b7413-77da-406a-ac0c-d20dc46db5e2/ecritures')
            .then(response => response.json())
            .then(data => {
                let tbody = document.createElement('tbody');

                for (let i = 0; i < data.items.length; i++) {
                    let ecritures = data.items[i]
                    pbody(ecritures);

                    function pbody(jsonObj){
                        let row = document.createElement('tr');

                        let td1 = document.createElement('td');
                        let td2 = document.createElement('td');
                        let td3 = document.createElement('td');
                        let td4 = document.createElement('td');
                        let td5 = document.createElement('td');
                        let td6 = document.createElement('td');
                        let td7 = document.createElement('td');

                        td1.textContent = jsonObj['uuid'];
                        td2.textContent = jsonObj['label'];
                        td3.textContent = jsonObj['date'];
                        td4.textContent = jsonObj['amount'];
                        td5.textContent = jsonObj['type'];
                        td6.textContent = jsonObj['created_at'];
                        td7.textContent = jsonObj['updated_at'];

                        for (let j = 0; j < 6;j++){
                            row.appendChild(td1);
                            row.appendChild(td2);
                            row.appendChild(td3);
                            row.appendChild(td4);
                            row.appendChild(td5);
                            row.appendChild(td6);
                            row.appendChild(td7);
                            tbody.appendChild(row)
                        }
                        body.appendChild(tbody);
                        document.getElementById('table').appendChild(tbody);


                    }
                }
            })}
</script>
</html>